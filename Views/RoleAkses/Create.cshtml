@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewData["Title"] = "Create System Level";
}

<div class="max-w-2xl mx-auto bg-white shadow-md rounded-xl p-6">
    <h2 class="text-xl font-semibold mb-6">Create System Level</h2>

    <form id="createSysLevelForm" class="space-y-4">
        <!-- Name -->
        <div>
            <label class="block text-sm font-medium text-gray-700">Name</label>
            <input type="text" name="name" required
                class="w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:outline-none"
                placeholder="Enter system level name">
        </div>

        <!-- Description -->
        <div>
            <label class="block text-sm font-medium text-gray-700">Description</label>
            <textarea name="description" rows="3"
                class="w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:outline-none"
                placeholder="Enter description"></textarea>
        </div>

        <!-- Save & Cancel -->
        <div class="flex justify-end space-x-3 pt-4">
            <a href="/SysLevel/Index"
                class="px-4 py-2 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-100">
                Cancel
            </a>
            <button type="submit" class="px-4 py-2 rounded-lg bg-teal-600 text-white hover:bg-teal-700">
                Save
            </button>
        </div>
    </form>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    $(document).ready(function () {
        // Handle create system level
        $("#createSysLevelForm").on("submit", function (e) {
            e.preventDefault();

            const formData = {
                name: $("input[name='name']").val(),
                description: $("textarea[name='description']").val()
            };

            $.ajax({
                url: "http://localhost:5125/api/syslevels",
                method: "POST",
                contentType: "application/json",
                data: JSON.stringify(formData),
                success: function (res) {
                    Swal.fire({
                        icon: 'success',
                        title: 'Success',
                        text: res.message || 'System Level has been created successfully!',
                        timer: 2000,
                        showConfirmButton: false
                    }).then(() => {
                        window.location.href = "/RoleAkses/Index"; // redirect ke list
                    });
                },
                error: function (xhr) {
                    const res = xhr.responseJSON;
                    Swal.fire({
                        icon: 'error',
                        title: 'Failed',
                        text: res?.message || 'Failed to create system level'
                    });
                }
            });
        });
    });
</script>
