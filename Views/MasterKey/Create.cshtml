@{
    ViewData["Title"] = "Create Master Key";
}

<div class="max-w-3xl mx-auto p-6">
    <!-- Header -->
    <div class="mb-6">
        <h1 class="text-lg text-gray-600">Master Key / Create</h1>
    </div>

    <!-- Form Card -->
    <div class="bg-white rounded-lg shadow-sm p-6">
        <form id="createMasterKeyForm" class="space-y-6">
            
            <!-- CODE -->
            <div class="flex items-center">
                <label for="mkeyCode"
                       class="block text-gray-700 text-sm font-medium uppercase tracking-wide w-32 text-right pr-4">
                    CODE:
                </label>
                <input type="text" id="mkeyCode" name="mkeyCode" required
                       class="flex-1 px-3 py-2 border border-gray-300 rounded focus:outline-none focus:border-blue-400 transition-colors text-sm" />
            </div>
            
            <!-- KEY NUMBER -->
            <div class="flex items-center">
                <label for="mkeyNumber"
                       class="block text-gray-700 text-sm font-medium uppercase tracking-wide w-32 text-right pr-4">
                    KEY NUMBER:
                </label>
                <input type="text" id="mkeyNumber" name="mkeyNumber"
                       class="flex-1 px-3 py-2 border border-gray-300 rounded focus:outline-none focus:border-blue-400 transition-colors text-sm" />
            </div>
            
            <!-- KETERANGAN -->
            <div class="flex items-center">
                <label for="mkeyDesc"
                       class="block text-gray-700 text-sm font-medium uppercase tracking-wide w-32 text-right pr-4">
                    KETERANGAN:
                </label>
                <input type="text" id="mkeyDesc" name="mkeyDesc"
                       class="flex-1 px-3 py-2 border border-gray-300 rounded focus:outline-none focus:border-blue-400 transition-colors text-sm" />
            </div>

            <hr class="my-6 border-gray-200">

            <!-- Action Buttons -->
            <div class="flex justify-end gap-3">
                <a asp-controller="MasterKey" asp-action="Index"
                   class="px-5 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded text-sm transition-colors">
                    Cancel
                </a>
                <button type="submit"
                        class="px-5 py-2 bg-teal-600 hover:bg-teal-700 text-white rounded text-sm transition-colors">
                    Create
                </button>
            </div>
        </form>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    const API_BASE = "http://localhost:5125";

    $("#createMasterKeyForm").on("submit", function (e) {
        e.preventDefault();

        const data = {
            mkeyCode: $("#mkeyCode").val(),
            mkeyNumber: $("#mkeyNumber").val(),
            mkeyDesc: $("#mkeyDesc").val()
        };

        $.ajax({
            url: `${API_BASE}/api/sysmkeys`,
            method: "POST",
            contentType: "application/json",
            data: JSON.stringify(data),
            success: function () {
                Swal.fire({
                    icon: 'success',
                    title: 'Berhasil',
                    text: 'Master Key berhasil ditambahkan!',
                    confirmButtonColor: '#3085d6'
                }).then(() => {
                    window.location.href = "/MasterKey/Index";
                });
            },
            error: function (xhr) {
                const msg = xhr.responseJSON?.message || "Gagal menyimpan data.";
                Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: msg,
                    confirmButtonColor: '#d33'
                });
            }
        });
    });
</script>
